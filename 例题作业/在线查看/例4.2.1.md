

```python
import numpy as np
import pandas as pd
from scipy.stats import f
# Numpy为数组矩阵运算库，pandas相当于python里面的excel，scipy.stats是统计学库
```


```python
# 写入数据
# 下标0表示城市男婴，下标1表示农村男婴

mu_0 = np.array([90,58,16]) #读取为array数组
mu_0 = pd.Series(mu_0,index=['身高','胸围','上半臀围']) # 将array数组
x_1_data = np.array([[78,60.6,16.5],[76,58.1,12.5],[92,63.2,14.5],[81,59,14],[81,60.8,15.5],[84,59.5,14]])
x_1_data = pd.DataFrame(x_1_data,columns=['身高','胸围','上半臀围'])
print('总体均值为:\n',mu_0)
print('------------------')
print('样本数据为:\n', x_1_data)
print('------------------')
```

    总体均值为:
     身高      90
    胸围      58
    上半臀围    16
    dtype: int32
    ------------------
    样本数据为:
          身高    胸围  上半臀围
    0  78.0  60.6  16.5
    1  76.0  58.1  12.5
    2  92.0  63.2  14.5
    3  81.0  59.0  14.0
    4  81.0  60.8  15.5
    5  84.0  59.5  14.0
    ------------------
    


```python
# 计算样本均值
x_ba = x_1_data.mean()
print('样本均值为：\n',x_ba)
print('------------------')
```

    样本均值为：
     身高      82.0
    胸围      60.2
    上半臀围    14.5
    dtype: float64
    ------------------
    


```python
# 计算协方差矩阵
S = x_1_data.cov()
print('样本协方差矩阵为：\n',S)
print('------------------')
```

    样本协方差矩阵为：
              身高     胸围  上半臀围
    身高    31.60  8.040  0.50
    胸围     8.04  3.172  1.31
    上半臀围   0.50  1.310  1.90
    ------------------
    


```python
# 计算霍特林统计量
n = 6
p = 3
T_2 = n * np.array((x_ba - mu_0)).T @ np.linalg.inv(S) @ np.array((x_ba - mu_0))
print('霍特林统计量为：',T_2)
print('------------------')
```

    霍特林统计量为： 420.44466187925707
    ------------------
    


```python
f_value = (n-p)/(p*(n-1)) * T_2
p_value = f.sf(f_value, p, n-p )
print('p-value:',p_value)
```

    p-value: 0.002155272045932368
    
